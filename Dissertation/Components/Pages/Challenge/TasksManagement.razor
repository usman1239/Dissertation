@page "/challenge/tasks"
@using Dissertation.View_Models
@rendermode InteractiveServer
@inject ChallengeDashboardViewModel ViewModel

<link rel="stylesheet" href="Styles/Challenge/Shared.css"/>
<link rel="stylesheet" href="Styles/Challenge/TasksManagement.css"/>


<h3>TasksManagement</h3>

<div>
	<h3>View Tasks</h3>
	<ul>
		@foreach (var story in ViewModel.UserStories)
		{
			@foreach (var task in story.Tasks)
			{
				<MudList T="string" ReadOnly="true">
					<MudListItem Text="User Story:" Icon="@Icons.Material.Filled.Title">
						@story.Title
					</MudListItem>
					
					<MudListItem Text="Task Title:" Icon="@Icons.Material.Filled.Assignment">
						@task.Title
					</MudListItem>

					<MudListItem Text="Task Type:" Icon="@Icons.Material.Filled.TypeSpecimen">
						@task.Type
					</MudListItem>

					<MudListItem Text="Assigned To:" Icon="@Icons.Material.Filled.Person">
						@task.AssignedTo?.Name
					</MudListItem>

					<MudListItem Text="Difficulty:" Icon="@Icons.Material.Filled.Info">
						@task.Difficulty
					</MudListItem>

					<MudListItem Text="Progress:" Icon="@Icons.Material.Filled.Propane">
						@task.Progress
					</MudListItem>
				</MudList>
			}
		}
	</ul>
</div>

<h3>Add and Assign Task</h3>

<div>
	<label>Select User Story:</label>
	<select @bind="ViewModel.SelectedUserStory">
		<option value="">-- Select a User Story --</option>
		@foreach (var story in ViewModel.UserStories)
		{
			<option value="@story.Title">@story.Title</option>
		}
	</select>
</div>

<div>
	<label>Task Name:</label>
	<input type="text" @bind="ViewModel.Task" placeholder="Write task here..."/>
</div>

<div>
	<label>Task Type:</label>
	<select @bind="ViewModel.SelectedTaskType">
		<option value="BacklogItem">Backlog Item</option>
		<option value="Bug">Bug</option>
	</select>
</div>

<div>
	<label>Select Developer:</label>
	<select @bind="ViewModel.SelectedDeveloper">
		<option value="">-- Select a Developer --</option>
		@foreach (var dev in ViewModel.Team)
		{
			<option value="@dev.Name">@dev.Name (@dev.ExperienceLevel)</option>
		}
	</select>
</div>

<button @onclick="ViewModel.AddAndAssignTaskToUserStory"
        disabled="@ViewModel.CanAddTaskToUserStory()">
	Add Task
</button>


<div>
	<NavLink href="/challenge" class="nav-link" active-class="active">⬅ Back to Dashboard</NavLink>
</div>